<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Piotr Nowicki">
<meta name="dcterms.date" content="2023-03-03">

<title>An investigation into stock market comovements between Central Europe and the USA using the ADCC model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="StockReturnsComovements-multiGARCH_files/libs/clipboard/clipboard.min.js"></script>
<script src="StockReturnsComovements-multiGARCH_files/libs/quarto-html/quarto.js"></script>
<script src="StockReturnsComovements-multiGARCH_files/libs/quarto-html/popper.min.js"></script>
<script src="StockReturnsComovements-multiGARCH_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="StockReturnsComovements-multiGARCH_files/libs/quarto-html/anchor.min.js"></script>
<link href="StockReturnsComovements-multiGARCH_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="StockReturnsComovements-multiGARCH_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="StockReturnsComovements-multiGARCH_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="StockReturnsComovements-multiGARCH_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="StockReturnsComovements-multiGARCH_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="StockReturnsComovements-multiGARCH_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="StockReturnsComovements-multiGARCH_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">An investigation into stock market comovements between Central Europe and the USA using the ADCC model</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Piotr Nowicki </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 3, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The aim of the research is to examine stock market comovements between Central Europe and the USA. This study follows closely the work of <span class="citation" data-cites="gjika2013">Gjika and Horváth (<a href="#ref-gjika2013" role="doc-biblioref">2013</a>)</span>. The main differences are:</p>
<ol type="1">
<li>Analysing comovements between Central Europe and the USA instead of the Eurozone.</li>
<li>Longer time window (2001 - 2022) instead of 2001-2011.</li>
<li>Taking into account the pandemic period.</li>
</ol>
<p>Central Europe is represented by the Czech Republic (PX), Hungary (BUX), and Poland (WIG). The USA market is defined as the S&amp;P500 index. The following hypotheses are stated:</p>
<ol type="1">
<li>The indexes exhibit asymmetric conditional variance.</li>
<li>The conditional correlation is asymmetric.</li>
<li>The conditional correlation increases over time.</li>
<li>The financial crisis and pandemic rise the conditional correlation.</li>
<li>The conditional variance is positively related to the conditional correlation.</li>
</ol>
<p>This work is meant to be as short as possible without going into details. It presents the necessary code for multivariate GARCH estimation in R and, to some extent, it expands the paper by <span class="citation" data-cites="gjika2013">Gjika and Horváth (<a href="#ref-gjika2013" role="doc-biblioref">2013</a>)</span>. If you are interested in any part of the work, you can contact me.</p>
</section>
<section id="data-description" class="level2">
<h2 class="anchored" data-anchor-id="data-description">Data description</h2>
<p>Below you can find basic data wrangling and plots.</p>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/data-preprocessing_f8243045c35e061c27c937e1ced9330a">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>libraries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"xts"</span>, <span class="st">"fBasics"</span>, <span class="st">"tseries"</span>, <span class="st">"FinTS"</span>, <span class="st">"rugarch"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"rmgarch"</span>, <span class="st">"urca"</span>, <span class="st">"reshape2"</span>, <span class="st">"ggplot2"</span>, <span class="st">"stargazer"</span>, <span class="st">"lmtest"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"kableExtra"</span>, <span class="st">"sandwich"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(libraries, require, <span class="at">character.only =</span> T)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>bux <span class="ot">&lt;-</span> <span class="st">"http://stooq.com/q/d/l/?s=^bux&amp;i=d"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="st">"http://stooq.com/q/d/l/?s=^px&amp;i=d"</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>wig <span class="ot">&lt;-</span> <span class="st">"http://stooq.com/q/d/l/?s=wig&amp;i=d"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>files_list <span class="ot">&lt;-</span> <span class="fu">c</span>(bux, px, wig)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>stocks <span class="ot">&lt;-</span> <span class="fu">lapply</span>(files_list, read_csv, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Close"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">map</span>(<span class="sc">~</span><span class="fu">transmute</span>(., </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Date =</span> <span class="fu">as.Date</span>(Date),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Value =</span> Close)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">map</span>(<span class="sc">~</span>dplyr<span class="sc">::</span><span class="fu">filter</span>(., Date <span class="sc">&gt;=</span> <span class="st">"2001-01-01"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            purrr<span class="sc">::</span><span class="fu">reduce</span>(inner_join, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>wd <span class="ot">&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"^spx_d.csv"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_select =</span> <span class="fu">c</span>(<span class="st">"Date"</span>, <span class="st">"Close"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="st">"2001-01-01"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>stocks <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(stocks, sp, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(stocks)[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BUX"</span>, <span class="st">"PX"</span>, <span class="st">"WIG"</span>, <span class="st">"SPX"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Besides PX, the stock market indexes follow roughly the same trend.</p>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/stock indexes graph_f3a51961635e4e417e3380df50f1324d">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>stocks_1 <span class="ot">&lt;-</span> stocks <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">PX =</span> PX<span class="sc">*</span><span class="dv">10</span>, <span class="at">SPX =</span> SPX<span class="sc">*</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">"Date"</span>, <span class="at">value.name =</span> <span class="st">"value"</span>, <span class="at">variable.name =</span> <span class="st">"stock"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>stocks_1, <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y=</span>value, <span class="at">group=</span>stock, <span class="at">colour=</span>stock))<span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Stock indexes"</span>, )<span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks=</span><span class="st">"3 years"</span>, <span class="at">date_labels=</span><span class="st">"%Y"</span>)<span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="StockReturnsComovements-multiGARCH_files/figure-html/stock%20indexes%20graph-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Summary statistics of the stock market indexes’ returns. The returns exhibit left-skewness, excess kurtosis, non-normality, autocorrelation, and ARCH effects. Hereafter, every analysis is conducted on the returns.</p>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/statistical description_2b26a9c99cec2a2a4be9e18dbe275f3f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># logarithm transformation</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>stocks[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, <span class="fu">lapply</span>(<span class="fu">log</span>(stocks[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]), diff.xts))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>stocks <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(stocks)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ADF test</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>ADF <span class="ot">&lt;-</span> <span class="fu">apply</span>(stocks[<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">summary</span>(<span class="fu">ur.df</span>(x, <span class="st">"none"</span>, <span class="at">selectlags=</span><span class="st">"AIC"</span>))<span class="sc">@</span>teststat)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Jarque-Bera test</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>JB <span class="ot">&lt;-</span> <span class="fu">apply</span>(stocks[<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">jarque.bera.test</span>(x)<span class="sc">$</span>p.value)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ljung-Box test</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>LB <span class="ot">&lt;-</span> <span class="fu">apply</span>(stocks[<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">Box.test</span>(x, <span class="at">lag =</span> <span class="dv">8</span>, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>)<span class="sc">$</span>p.value)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ARCH LM test</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>ARCH <span class="ot">&lt;-</span> <span class="fu">apply</span>(stocks[<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">ArchTest</span>(x, <span class="at">lags =</span> <span class="dv">4</span>)<span class="sc">$</span>p.value)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">basicStats</span>(stocks[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])[<span class="fu">c</span>(<span class="st">"Mean"</span>,<span class="st">"Stdev"</span>,<span class="st">"Skewness"</span>, <span class="st">"Kurtosis"</span>, <span class="st">"Minimum"</span>, <span class="st">"Maximum"</span>),] <span class="sc">%&gt;%</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(ADF, JB, LB, ARCH) <span class="sc">%&gt;%</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">rownames&lt;-</span><span class="st">`</span>(<span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Stdev"</span>, </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Skewness"</span>, <span class="st">"Kurtosis"</span>, </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Min"</span>, <span class="st">"Max."</span>, </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ADF"</span>, <span class="st">"Jarque-Bera"</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Ljung-Box"</span>, <span class="st">"ARCH-LM"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Times New Roman"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"For the ADF test, statistics' values were provided. </span><span class="sc">\n</span><span class="st"> For other tests, p-values were shown."</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">general_title =</span> <span class="st">"Notes: "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-classic" style="font-family: Times New Roman; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:right;"> BUX </th>
   <th style="text-align:right;"> PX </th>
   <th style="text-align:right;"> WIG </th>
   <th style="text-align:right;"> SPX </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Mean </td>
   <td style="text-align:right;"> 0.000341 </td>
   <td style="text-align:right;"> 0.000181 </td>
   <td style="text-align:right;"> 0.0002290 </td>
   <td style="text-align:right;"> 0.000213 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Stdev </td>
   <td style="text-align:right;"> 0.015478 </td>
   <td style="text-align:right;"> 0.013798 </td>
   <td style="text-align:right;"> 0.0130770 </td>
   <td style="text-align:right;"> 0.012866 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Skewness </td>
   <td style="text-align:right;"> -0.028454 </td>
   <td style="text-align:right;"> -1.133005 </td>
   <td style="text-align:right;"> -0.5887010 </td>
   <td style="text-align:right;"> -0.503379 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Kurtosis </td>
   <td style="text-align:right;"> 13.910827 </td>
   <td style="text-align:right;"> 20.813645 </td>
   <td style="text-align:right;"> 7.4698990 </td>
   <td style="text-align:right;"> 10.460218 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Min </td>
   <td style="text-align:right;"> -0.126489 </td>
   <td style="text-align:right;"> -0.199020 </td>
   <td style="text-align:right;"> -0.1352650 </td>
   <td style="text-align:right;"> -0.127652 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Max. </td>
   <td style="text-align:right;"> 0.220163 </td>
   <td style="text-align:right;"> 0.123641 </td>
   <td style="text-align:right;"> 0.0846410 </td>
   <td style="text-align:right;"> 0.109572 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ADF </td>
   <td style="text-align:right;"> -53.115133 </td>
   <td style="text-align:right;"> -53.684899 </td>
   <td style="text-align:right;"> -49.9110715 </td>
   <td style="text-align:right;"> -54.148276 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Jarque-Bera </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.0000000 </td>
   <td style="text-align:right;"> 0.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Ljung-Box </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.0467232 </td>
   <td style="text-align:right;"> 0.000000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ARCH-LM </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.000000 </td>
   <td style="text-align:right;"> 0.0000000 </td>
   <td style="text-align:right;"> 0.000000 </td>
  </tr>
</tbody>
<tfoot>
<tr><td style="padding: 0; " colspan="100%"><span style="font-style: italic;">Notes: </span></td></tr>
<tr><td style="padding: 0; " colspan="100%">
<sup></sup> For the ADF test, statistics' values were provided. <br> For other tests, p-values were shown.</td></tr>
</tfoot>
</table>

</div>
</div>
<p>Unconditional correlations are moderate within Central Europe and low between Central Europe and the USA. It is worth noting that the unconditional correlations vis-a-vis the Eurozone are higher than for the USA in <span class="citation" data-cites="gjika2013">Gjika and Horváth (<a href="#ref-gjika2013" role="doc-biblioref">2013</a>)</span>.</p>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/Pearson correlation_212eb5aaf4d12bed87444cae737587f8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(stocks[<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          BUX        PX       WIG       SPX
BUX 1.0000000 0.5877131 0.5991965 0.3860973
PX  0.5877131 1.0000000 0.6125538 0.3819221
WIG 0.5991965 0.6125538 1.0000000 0.4269699
SPX 0.3860973 0.3819221 0.4269699 1.0000000</code></pre>
</div>
</div>
<p>The returns for the stock market indexes. The ARCH effects can be seen for some periods.</p>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/plots for the time series' returns_5ee7540b312a54708048958f3bab313c">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>stocks_2 <span class="ot">&lt;-</span> <span class="fu">melt</span>(stocks, <span class="at">id.vars =</span> <span class="st">"Date"</span>, <span class="at">value.name =</span> <span class="st">"value"</span>, <span class="at">variable.name =</span> <span class="st">"stock"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>stocks_2, <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y=</span>value, <span class="at">group=</span>stock, <span class="at">color=</span>stock))<span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>stock)<span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks=</span><span class="st">"4 years"</span>, <span class="at">date_labels=</span><span class="st">"%Y"</span>)<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="StockReturnsComovements-multiGARCH_files/figure-html/plots%20for%20the%20time%20series'%20returns-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="specifying-garch-models" class="level2">
<h2 class="anchored" data-anchor-id="specifying-garch-models">Specifying GARCH models</h2>
<p>4 models will be fitted to the data: standard GARCH, GJR-GARCH (an asymmetric conditional variance), absolute value GARCH, and TGRACH (an asymmetric standard deviation). For each of the models ARMA(1,0) and GARCH(1,1) were fitted in accordance with <span class="citation" data-cites="gjika2013">Gjika and Horváth (<a href="#ref-gjika2013" role="doc-biblioref">2013</a>)</span>. The best models are chosen by minimising BIC.</p>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/defining univariate GARCH specifications_6761a69065f899b3f3a1c41252c10117">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sGARCH_spec <span class="ot">&lt;-</span> <span class="fu">ugarchspec</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean.model =</span> <span class="fu">list</span>(<span class="at">armaOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">include.mean =</span> T),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">variance.model =</span> <span class="fu">list</span>(<span class="at">model =</span> <span class="st">"sGARCH"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">garchOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">distribution.model =</span> <span class="st">"std"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>gjrGARCH_spec <span class="ot">&lt;-</span> <span class="fu">ugarchspec</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mean.model =</span> <span class="fu">list</span>(<span class="at">armaOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">include.mean =</span> T),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">variance.model =</span> <span class="fu">list</span>(<span class="at">model =</span> <span class="st">"gjrGARCH"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">garchOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">distribution.model=</span> <span class="st">"std"</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>avGARCH_spec <span class="ot">&lt;-</span> <span class="fu">ugarchspec</span>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean.model =</span> <span class="fu">list</span>(<span class="at">armaOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">include.mean =</span> T),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">variance.model =</span> <span class="fu">list</span>(<span class="at">model =</span> <span class="st">"apARCH"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">garchOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">distribution.model=</span> <span class="st">"std"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed.pars =</span> <span class="fu">list</span>(<span class="at">gamma1 =</span> <span class="dv">0</span>, <span class="at">delta =</span> <span class="dv">1</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>TGARCH_spec <span class="ot">&lt;-</span> <span class="fu">ugarchspec</span>(</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean.model =</span> <span class="fu">list</span>(<span class="at">armaOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">include.mean =</span> T),</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">variance.model =</span> <span class="fu">list</span>(<span class="at">model =</span> <span class="st">"apARCH"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>                        <span class="at">garchOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)),</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">distribution.model=</span> <span class="st">"std"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixed.pars =</span> <span class="fu">list</span>(<span class="at">delta =</span> <span class="dv">1</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>sGARCH_bayes <span class="ot">&lt;-</span> <span class="fu">apply</span>(stocks[<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">infocriteria</span>(<span class="fu">ugarchfit</span>(sGARCH_spec, x))[<span class="dv">2</span>])</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>gjrGARCH_bayes <span class="ot">&lt;-</span> <span class="fu">apply</span>(stocks[<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">infocriteria</span>(<span class="fu">ugarchfit</span>(gjrGARCH_spec, x))[<span class="dv">2</span>])</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>avGARCH_bayes <span class="ot">&lt;-</span> <span class="fu">apply</span>(stocks[<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">infocriteria</span>(<span class="fu">ugarchfit</span>(avGARCH_spec, x, <span class="at">solver =</span> <span class="st">'hybrid'</span>))[<span class="dv">2</span>])</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>TGARCH_bayes <span class="ot">&lt;-</span> <span class="fu">apply</span>(stocks[<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">infocriteria</span>(<span class="fu">ugarchfit</span>(TGARCH_spec, x))[<span class="dv">2</span>])</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian IC</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sGARCH_bayes, gjrGARCH_bayes, avGARCH_bayes, TGARCH_bayes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     BUX        PX       WIG       SPX
sGARCH_bayes   -5.828545 -6.245000 -6.116783 -6.432417
gjrGARCH_bayes -5.832957 -6.246767 -6.123487 -6.461511
avGARCH_bayes  -5.823061 -6.244851 -6.113565 -6.430099
TGARCH_bayes   -5.829853 -6.250765 -6.124298 -6.473286</code></pre>
</div>
</div>
<p>The following GARCH specifications are fitted: GJR-GARCH (BUX), TGARCH (PX, WIG, SPX). Below you can find the conditional standard deviations plots.</p>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/conditional standard deviations_905af441c8a706b70b469175b405b1de">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BUX - GJRGARCH; PX - AVGARCH; WIG - AVGARCH; SPX - TGARCH</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>bux_garch <span class="ot">&lt;-</span> <span class="fu">ugarchfit</span>(gjrGARCH_spec, stocks<span class="sc">$</span>BUX)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>px_garch <span class="ot">&lt;-</span> <span class="fu">ugarchfit</span>(TGARCH_spec, stocks<span class="sc">$</span>PX)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>wig_garch <span class="ot">&lt;-</span> <span class="fu">ugarchfit</span>(TGARCH_spec, stocks<span class="sc">$</span>WIG)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>spx_garch <span class="ot">&lt;-</span> <span class="fu">ugarchfit</span>(TGARCH_spec, stocks<span class="sc">$</span>SPX)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of conditional standard deviations</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>stocks_3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> stocks<span class="sc">$</span>Date,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">BUX =</span> bux_garch<span class="sc">@</span>fit<span class="sc">$</span>sigma,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">PX =</span> px_garch<span class="sc">@</span>fit<span class="sc">$</span>sigma,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">WIG =</span> wig_garch<span class="sc">@</span>fit<span class="sc">$</span>sigma,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">SPX =</span> spx_garch<span class="sc">@</span>fit<span class="sc">$</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">"Date"</span>, <span class="at">value.name =</span> <span class="st">"sigma"</span>, <span class="at">variable.name =</span> <span class="st">"stock"</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>stocks_3, <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y=</span>sigma, <span class="at">group=</span>stock, <span class="at">color=</span>stock))<span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>stock)<span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks=</span><span class="st">"4 years"</span>, <span class="at">date_labels=</span><span class="st">"%Y"</span>)<span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="StockReturnsComovements-multiGARCH_files/figure-html/conditional%20standard%20deviations-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="conditional-correlations" class="level2">
<h2 class="anchored" data-anchor-id="conditional-correlations">Conditional correlations</h2>
<p>The next plot shows the conditional correlations from the DCC (1,1) model fitted to every pair. The asymmetry was not found to be statistically significant, therefore only DCC is applied.</p>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/conditional correlation_9c6813c9ba691d52866ad35abe78e7cc">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BUX - PX</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>uspec1 <span class="ot">&lt;-</span> <span class="fu">multispec</span>(<span class="fu">c</span>(gjrGARCH_spec, TGARCH_spec))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>adcc1 <span class="ot">&lt;-</span> <span class="fu">dccspec</span>(uspec1, <span class="at">dccOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"mvnorm"</span>, <span class="at">model =</span> <span class="st">"DCC"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">dccfit</span>(adcc1, <span class="at">data =</span> stocks[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># BUX - WIG</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>uspec2 <span class="ot">&lt;-</span> <span class="fu">multispec</span>(<span class="fu">c</span>(gjrGARCH_spec, TGARCH_spec))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>adcc2 <span class="ot">&lt;-</span> <span class="fu">dccspec</span>(uspec2, <span class="at">dccOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"mvnorm"</span>, <span class="at">model =</span> <span class="st">"DCC"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">dccfit</span>(adcc2, <span class="at">data =</span> stocks[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)])</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># PX - WIG</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>uspec3 <span class="ot">&lt;-</span> <span class="fu">multispec</span>(<span class="fu">c</span>(TGARCH_spec, TGARCH_spec))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>adcc3 <span class="ot">&lt;-</span> <span class="fu">dccspec</span>(uspec3, <span class="at">dccOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"mvnorm"</span>, <span class="at">model =</span> <span class="st">"DCC"</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">dccfit</span>(adcc3, <span class="at">data =</span> stocks[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)])</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># BUX - SPX</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>uspec4 <span class="ot">&lt;-</span> <span class="fu">multispec</span>(<span class="fu">c</span>(gjrGARCH_spec, TGARCH_spec))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>adcc4 <span class="ot">&lt;-</span> <span class="fu">dccspec</span>(uspec4, <span class="at">dccOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"mvnorm"</span>, <span class="at">model =</span> <span class="st">"DCC"</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">dccfit</span>(adcc4, <span class="at">data =</span> stocks[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)])</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># PX - SPX</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>uspec5 <span class="ot">&lt;-</span> <span class="fu">multispec</span>(<span class="fu">c</span>(TGARCH_spec, TGARCH_spec))</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>adcc5 <span class="ot">&lt;-</span> <span class="fu">dccspec</span>(uspec5, <span class="at">dccOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"mvnorm"</span>, <span class="at">model =</span> <span class="st">"DCC"</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">dccfit</span>(adcc5, <span class="at">data =</span> stocks[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)])</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># WIG - SPX</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>uspec6 <span class="ot">&lt;-</span> <span class="fu">multispec</span>(<span class="fu">c</span>(TGARCH_spec, TGARCH_spec))</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>adcc6 <span class="ot">&lt;-</span> <span class="fu">dccspec</span>(uspec6, <span class="at">dccOrder =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">distribution =</span> <span class="st">"mvnorm"</span>, <span class="at">model =</span> <span class="st">"DCC"</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>fit6 <span class="ot">&lt;-</span> <span class="fu">dccfit</span>(adcc6, <span class="at">data =</span> stocks[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)])</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co"># plot conditional correlations</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>stocks_4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> stocks<span class="sc">$</span>Date,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">BUXPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit1, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">BUXWIG =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit2, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">PXWIG =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit3, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">BUXSPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit4, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">PXSPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit5, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">WIGSPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit6, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>            <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">"Date"</span>, <span class="at">value.name =</span> <span class="st">"corrs"</span>, <span class="at">variable.name =</span> <span class="st">"pair"</span>)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>stocks_4, <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y=</span>corrs, <span class="at">group=</span>pair, <span class="at">color=</span>pair))<span class="sc">+</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pair, <span class="at">ncol =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks=</span><span class="st">"4 years"</span>, <span class="at">date_labels=</span><span class="st">"%Y"</span>)<span class="sc">+</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="StockReturnsComovements-multiGARCH_files/figure-html/conditional%20correlation-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="conditional-correlation-during-stress-periods" class="level2">
<h2 class="anchored" data-anchor-id="conditional-correlation-during-stress-periods">Conditional correlation during stress periods</h2>
<p>The following models will be estimated. Equation (1) refers to the effect of the financial crisis and pandemic on the conditional correlation. Whereas equation (2) tests the effect of the conditional standard deviation on the conditional correlation.</p>
<p><span id="eq-1"><span class="math display">\[
\rho_{i j, t} = \beta_0 + \beta_1I_{crisis} + \beta_2I_{pandemic} + \epsilon_{ij,t}
\tag{1}\]</span></span></p>
<p><span id="eq-2"><span class="math display">\[
\rho_{ij,t} = \alpha_0 + \alpha_1\sigma_{i,t} + \alpha_2\sigma_{j,t} + \epsilon_{ij,t}
\tag{2}\]</span></span></p>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/the financial crisis and pandemic_8d2f0609c8aea62b4a4ab6cfffa5481e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>stocks_5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> stocks<span class="sc">$</span>Date,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">BUXPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit1, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">BUXWIG =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit2, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">PXWIG =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit3, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">BUXSPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit4, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">PXSPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit5, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">WIGSPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit6, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">crisis =</span> <span class="fu">ifelse</span>(Date <span class="sc">&gt;=</span> <span class="st">"2008-09-15"</span> <span class="sc">&amp;</span> Date <span class="sc">&lt;=</span> <span class="st">"2011-11-11"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">pandemic =</span> <span class="fu">ifelse</span>(Date <span class="sc">&gt;=</span> <span class="st">"2020-03-11"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">lapply</span>(stocks_5[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>], <span class="cf">function</span>(x) <span class="fu">lm</span>(x <span class="sc">~</span> crisis <span class="sc">+</span> pandemic, <span class="at">data=</span>stocks_5))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>models2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(models, <span class="cf">function</span>(x) <span class="fu">coeftest</span>(x, <span class="at">vcov. =</span> vcovHAC)) <span class="co">#robust SE</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BUXPX"</span>, <span class="st">"BUXWIG"</span>, <span class="st">"PXWIG"</span>, <span class="st">"BUXPSX"</span>, <span class="st">"PXSPX"</span>, <span class="st">"WIGSPX"</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(models2, <span class="at">type=</span><span class="st">"text"</span>, </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> labels, </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">model.numbers =</span> F, </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">notes.label =</span> <span class="st">"Notes:"</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">notes =</span> <span class="st">"HAC standard errors"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">covariate.labels =</span> <span class="fu">c</span>(<span class="st">"crisis"</span>, <span class="st">"pandemic"</span>, <span class="st">"constant"</span>),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">dep.var.caption =</span> <span class="st">"conditional correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
==============================================================
                        conditional correlation               
         -----------------------------------------------------
                                                              
          BUXPX    BUXWIG   PXWIG    BUXPSX   PXSPX    WIGSPX 
--------------------------------------------------------------
crisis   0.075*** 0.085*** 0.135*** 0.094*** 0.072*** 0.087***
         (0.024)  (0.023)  (0.036)  (0.018)  (0.021)  (0.024) 
                                                              
pandemic  -0.003   0.022    0.026    -0.002   0.004    0.052  
         (0.023)  (0.026)  (0.039)  (0.024)  (0.028)  (0.034) 
                                                              
constant 0.484*** 0.522*** 0.514*** 0.287*** 0.315*** 0.370***
         (0.011)  (0.011)  (0.020)  (0.011)  (0.020)  (0.023) 
                                                              
==============================================================
==============================================================
Notes:                             *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01
                                           HAC standard errors</code></pre>
</div>
</div>
<div class="cell" data-hash="StockReturnsComovements-multiGARCH_cache/html/conditional correlations and standard deviations_8cc07a98e69d382b7f634887b63dc34e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>stocks_6 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> stocks<span class="sc">$</span>Date,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">BUXSPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit4, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">PXSPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit5, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">WIGSPX =</span> <span class="fu">as.vector</span>(<span class="fu">rcor</span>(fit6, <span class="at">type=</span><span class="st">"R"</span>, <span class="at">output=</span><span class="st">"matrix"</span>)),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">BUX =</span> bux_garch<span class="sc">@</span>fit<span class="sc">$</span>sigma,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">PX =</span> px_garch<span class="sc">@</span>fit<span class="sc">$</span>sigma,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">WIG =</span> wig_garch<span class="sc">@</span>fit<span class="sc">$</span>sigma,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">SPX =</span> spx_garch<span class="sc">@</span>fit<span class="sc">$</span>sigma)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BUXSPX <span class="sc">~</span> BUX <span class="sc">+</span> SPX, <span class="at">data =</span> stocks_6)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(PXSPX <span class="sc">~</span> PX <span class="sc">+</span> SPX, <span class="at">data =</span> stocks_6)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(WIGSPX <span class="sc">~</span> WIG <span class="sc">+</span> SPX, <span class="at">data =</span> stocks_6)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>all_models <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">list</span>(m1, m2, m3), <span class="cf">function</span>(x) <span class="fu">coeftest</span>(x, <span class="at">vcov. =</span> NeweyWest))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BUX-SPX"</span>, <span class="st">"PX-SPX"</span>, <span class="st">"WIG-SPX"</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(all_models, <span class="at">type=</span><span class="st">"text"</span>, </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">column.labels =</span> labs, </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">model.numbers =</span> F, </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">notes.label =</span> <span class="st">"Notes:"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">notes =</span> <span class="st">"HAC standard errors"</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">dep.var.caption =</span> <span class="st">"conditional correlation"</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">covariate.labels =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"constant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================
            conditional correlation   
         -----------------------------
                                      
          BUX-SPX   PX-SPX    WIG-SPX 
--------------------------------------
BUX        2.307                      
          (1.678)                     
                                      
PX                   0.885            
                    (1.399)           
                                      
constant                       2.864  
                              (3.016) 
                                      
SPX       3.044**    1.391     0.796  
          (1.269)   (1.160)   (1.585) 
                                      
Constant 0.234***  0.300***  0.346*** 
          (0.015)   (0.021)   (0.038) 
                                      
======================================
======================================
Notes:     *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01
                   HAC standard errors</code></pre>
</div>
</div>
<p>The estimation of equation (1) points to the increase of conditional correlation during the financial crisis but the pandemic did not have any effect.</p>
<p>The estimation of equation (2) shows no relation between the conditional correlations and conditional standard deviations.</p>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>Regarding the hypotheses stated in the introduction, the following conclusions can be drawn:</p>
<ol type="1">
<li>The indexes exhibit the asymmetric conditional variance. The best GARCH models were asymmetric ones: GJR-GARCH and TGARCH.</li>
<li>There is no asymmetric conditional correlation between the indexes. DCC (1,1) is sufficient.</li>
<li>The conditional correlations are not strictly increasing. Over the longer period, they are stable for the Central European countries. There might have been a small upward change between Central Europe and the USA.</li>
<li>The financial crisis was associated with an increase in the conditional correlations. However, the pandemic was not.</li>
<li>The conditional standard deviation is not positively related to the conditional correlation.</li>
</ol>
<p>The results (1) and (2) are the same as in <span class="citation" data-cites="gjika2013">Gjika and Horváth (<a href="#ref-gjika2013" role="doc-biblioref">2013</a>)</span>. The (3) is different - the longer time window shows the reverse to the mean that could not be seen in the referenced study. The association between the financial crisis and conditional correlations was also confirmed. Interestingly enough, the pandemic did not have a similar effect (probably due to the different responses from policymakers). Lastly, (5) is at odds with the findings of <span class="citation" data-cites="gjika2013">Gjika and Horváth (<a href="#ref-gjika2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>That being said, it seems a diversification benefit is not overestimated in a portfolio consisting of assets from Central Europe and the USA - contrary to the Eurozone in <span class="citation" data-cites="gjika2013">Gjika and Horváth (<a href="#ref-gjika2013" role="doc-biblioref">2013</a>)</span>. It is also not clear whether during a crisis the diversification benefit is reduced (but it was the case in the financial crisis).</p>
</section>
<section id="references" class="level2 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-gjika2013" class="csl-entry" role="doc-biblioentry">
Gjika, Dritan, and Roman Horváth. 2013. <span>“Stock Market Comovements in Central Europe: Evidence from the Asymmetric DCC Model.”</span> <em>Economic Modelling</em> 33 (July): 55–64. <a href="https://doi.org/10.1016/j.econmod.2013.03.015">https://doi.org/10.1016/j.econmod.2013.03.015</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>